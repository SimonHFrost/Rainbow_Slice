<html>
	<head>
		<title>Roller Ball</title>
		<style>canvas { width: 100%; height: 100% }</style>
	</head>
	<body>
    <script src="https://rawgithub.com/mrdoob/three.js/master/build/three.js"></script>
    <script src="https://rawgithub.com/mrdoob/three.js/master/examples/js/effects/AsciiEffect.js"></script>
    <script src="keyboard.js"></script>

		<script>
			var container, stats;
			var camera, scene, renderer;
			var sphere, plane;
			var start = Date.now();

			init();
			animate();

			function init() {
				var width = window.innerWidth || 2 - 20;
				var height = window.innerHeight || 2 - 20;

				container = document.createElement( 'div' );
				document.body.appendChild( container );

				camera = new THREE.PerspectiveCamera( 45, width / height, 1, 2500 );
				camera.position.y = 2000;
				camera.rotation.x = -1.57; // -90 degrees in rads

				scene = new THREE.Scene();

				var light = new THREE.PointLight( 0xff0000 );
				light.position.set( 500, 500, 500 );
				scene.add( light );

				var light = new THREE.PointLight( 0x0000ff );
				light.position.set( - 500, - 500, - 500 );
				scene.add( light );

				initSceneObjects();

				renderer = new THREE.CanvasRenderer();
				renderer.setSize( width, height );

				// ASCII Effect

				effect = new THREE.AsciiEffect( renderer );
				effect.setSize( width, height );

				// Swap the comment on the following two lines to toggle the ascii effect
				// container.appendChild( effect.domElement );
				container.appendChild(renderer.domElement);

				window.addEventListener( 'resize', onWindowResize, false );
      }

			function initSceneObjects() {
				// Sphere
				sphere = new THREE.Mesh( new THREE.SphereGeometry( 200, 20, 10 ), new THREE.MeshLambertMaterial( { shading: THREE.FlatShading } ) );
				scene.add( sphere );

				// Plane
				plane = new THREE.Mesh( new THREE.PlaneGeometry( 1000, 400 ), new THREE.MeshBasicMaterial( { color: 0xE0E0E0 } ) );
				plane.position.y = - 200;
				plane.rotation.x = - Math.PI / 2;
				scene.add( plane );

				// Wall
				wall = new THREE.Mesh( new THREE.PlaneGeometry( 3000, 3000 ), new THREE.MeshBasicMaterial( { color: 0xA0A0A0} ));
				wall.position.y = - 200;
				wall.position.z = - 200;
				// scene.add( wall );
			}

			function onWindowResize() {
				camera.aspect = window.innerWidth / window.innerHeight;
				camera.updateProjectionMatrix();

				renderer.setSize( window.innerWidth, window.innerHeight );
				effect.setSize( window.innerWidth, window.innerHeight );
			}

			function animate() {
				requestAnimationFrame( animate );

				render();
			}

			function render() {
				var timer = Date.now() - start;

				var rotationSpeed = 0.04;
				var translationSpeed = 10;

				if (Key.isDown(Key.A)) {
        	sphere.position.x -= translationSpeed;
					sphere.rotation.z += rotationSpeed;
        } else if (Key.isDown(Key.D)) {
					sphere.position.x += translationSpeed;
					sphere.rotation.z -= rotationSpeed;
				} else if (Key.isDown(Key.W)) {
					sphere.position.z -= translationSpeed;
					sphere.rotation.x -= rotationSpeed;
				} else if (Key.isDown(Key.S)) {
					sphere.position.z += translationSpeed;
					sphere.rotation.x += rotationSpeed;
				}

				effect.render( scene, camera );
			}

		</script>
	</body>
</html>
